<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="旅程详情 - 我的故事">
  <title>旅程详情 - 个人成长网站</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/pages/trip-detail.css">
</head>
<body>
  <!-- 顶部导航栏 -->
  <nav class="navbar">
    <div class="navbar-container">
      <a href="../nav.html" class="navbar-logo">
        <span class="logo-icon">✨</span>
        <span class="logo-text">个人成长</span>
      </a>
      <h1 class="navbar-title">旅程详情</h1>
      <div class="navbar-actions">
        <button class="nav-btn" id="deleteBtn" onclick="deleteTrip()" title="删除">
          <i class="fas fa-trash"></i>
        </button>
        <button class="nav-btn" id="editBtn" onclick="toggleEditMode()" title="编辑">
          <i class="fas fa-edit"></i>
        </button>
        <button class="nav-btn" id="backBtn" onclick="goBack()" title="返回">
          <i class="fas fa-arrow-left"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- 主要内容 -->
  <main class="main-content">
    <!-- 旅程信息卡片 -->
    <div class="trip-info-card">
      <div id="viewMode" class="trip-info">
        <div class="trip-header">
          <h2 id="provinceTitle"></h2>
          <div class="trip-dates">
            <span class="date-range">
              <i class="fas fa-calendar"></i>
              <span id="dateRange"></span>
            </span>
          </div>
        </div>
        <div class="trip-meta">
          <div class="meta-row">
            <span class="meta-label">同行人：</span>
            <span id="companionsText" class="meta-value">—</span>
          </div>
          <div class="meta-row">
            <span class="meta-label">评分：</span>
            <span id="ratingText" class="meta-value">—</span>
          </div>
        </div>
        <div class="trip-description">
          <p id="descriptionText"></p>
        </div>
      </div>

      <div id="editMode" class="trip-edit" style="display: none;">
        <form id="editForm">
          <div class="form-group">
            <label for="editProvince">省份</label>
            <input type="text" id="editProvince" class="form-control" disabled>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="editStartDate">开始日期</label>
              <input type="date" id="editStartDate" class="form-control" required>
            </div>
            <div class="form-group">
              <label for="editEndDate">结束日期</label>
              <input type="date" id="editEndDate" class="form-control" required>
            </div>
          </div>
          <div class="form-group">
            <label for="editCompanions">同行人</label>
            <input type="text" id="editCompanions" class="form-control" placeholder="例如：朋友A、B、C 或 家人">
          </div>
          <div class="form-group">
            <label for="editDescription">描述</label>
            <textarea id="editDescription" class="form-control" rows="4"></textarea>
          </div>
          <div class="form-group">
            <label for="editRating">评分</label>
            <div class="rating-input">
              <input type="range" id="editRating" min="1" max="5" value="3" class="form-control" style="cursor: pointer;">
              <span id="editRatingDisplay" style="margin-left: 10px; font-weight: bold;">★★★☆☆ (3/5)</span>
            </div>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-outline" onclick="toggleEditMode()">取消</button>
            <button type="button" class="btn btn-primary" onclick="saveEdit()">保存</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 照片瀑布流 -->
    <section class="photos-section">
      <div class="section-header">
        <h3>照片 <span class="photo-count" id="photoCount">(0)</span></h3>
        <button class="btn btn-primary btn-sm" id="addPhotoBtn" onclick="openAddPhotoModal()">
          <i class="fas fa-image"></i> 添加照片
        </button>
      </div>

      <div class="photos-waterfall" id="photosWaterfall">
        <!-- 动态生成的照片卡片 -->
      </div>

      <div id="emptyState" class="empty-state">
        <i class="fas fa-image"></i>
        <p>暂无照片，点击「添加照片」上传</p>
      </div>
    </section>
  </main>

  <!-- 添加照片模态框 -->
  <div id="addPhotoModal" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <h3>添加照片</h3>
        <button class="modal-close" onclick="closeAddPhotoModal()">×</button>
      </div>
      <div class="modal-body">
        <form id="photoForm">
          <div class="form-group">
            <label for="photoTitle">照片标题</label>
            <input type="text" id="photoTitle" class="form-control" placeholder="给这张照片起个名字">
          </div>
          <div class="form-group">
            <label for="photoDescription">照片说明</label>
            <textarea id="photoDescription" class="form-control" placeholder="记录照片背后的故事..." rows="3"></textarea>
          </div>
          <div class="form-group">
            <label for="photoFile">选择图片 <span class="required">*</span></label>
            <div class="file-input-wrapper">
              <input type="file" id="photoFile" class="form-control" accept="image/*" required>
              <div class="file-input-label">
                <i class="fas fa-cloud-upload-alt"></i>
                <span id="fileName">点击选择或拖拽图片</span>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="closeAddPhotoModal()">取消</button>
        <button class="btn btn-primary" onclick="savePhoto()">上传</button>
      </div>
    </div>
  </div>

  <!-- 照片灯箱 -->
  <div id="photoLightbox" class="lightbox" style="display: none;">
    <div class="lightbox-content">
      <button class="lightbox-close" onclick="closeLightbox()">×</button>
      <img id="lightboxImage" src="" alt="">
      <div class="lightbox-info">
        <h3 id="lightboxTitle"></h3>
        <p id="lightboxDescription"></p>
      </div>
    </div>
  </div>

  <script src="../js/storage.js"></script>
  <script src="../js/pages/trip-detail.js"></script>
</body>
</html>
